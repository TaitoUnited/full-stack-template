# Routing

This project uses [TanStack Router](https://tanstack.com/router) with [virtual routes](https://tanstack.com/router/v1/docs/framework/react/routing/virtual-file-routes) to define the application's routing structure. We also combine it with Apollo Client to preload data for pages, enhancing the user experience by reducing loading times.

## Route Configuration

As we are using [virtual routes](https://tanstack.com/router/v1/docs/framework/react/routing/virtual-file-routes), the routes are defined in a declarative way using a tree structure. This allows us to define the routes in a single file and have them automatically generated.

The route are therefore defined in the `route-config.ts` file.

Here's an example of how the routes can be set up:

```typescript
import { index, layout, rootRoute, route } from '@tanstack/virtual-file-routes';

export const routeConfig = rootRoute('root.tsx', [
  layout('app', 'layout.tsx', [
    index('index.tsx'),
    route('/$workspaceId', 'workspace/workspace.route.tsx', [
      index('home/home.route.tsx'),
      route('/posts', 'post-list/post-list.route.tsx'),
      route('/posts_/create', 'post-create/post-create.route.tsx'),
      route('/posts_/$id', 'post/post.route.tsx'),
    ]),
  ]),
  route('/login', 'login/login.route.tsx'),
]);
```

Updating this file will automatically update the routes in the application.

You can find them in the [`route-tree.gen.ts`](/client/src/route-tree.gen.ts) file, which is an autogenerated file that contains the routes information needed by Tanstack router.

## Route files

Each route is defined in the `src/routes` directory and is given the `.route.tsx` extension.

Here's an example of a route file:

```tsx
// src/routes/home/home.route.tsx
export const Route = createFileRoute('/_app/$workspaceId/')({
  component: HomeRoute,
});

function HomeRoute() {
  ...
}
```

## Preloading data

To preload data for a route, you can use the `loader` function in the route configuration. This function is called before rendering the component, allowing you to fetch the data needed for the page.

For more information, refer to the [GraphQL](./graphql.md#usage-with-router) documentation.
